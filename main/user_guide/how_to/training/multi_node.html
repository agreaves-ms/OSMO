

<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Multi-Node Distributed Training &#8212; OSMO Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/nvidia-sphinx-theme.css?v=df3ac72c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/collapsible_code_block.css?v=fddc5587" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/base.css?v=f411dd76" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/lifecycle-timeline.css?v=b1697d17" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/mermaid_custom.css?v=e845640e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/versioning.css?v=ed00f604" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=1c0753c3"></script>
    <script src="../../../_static/js/collapsible_code_block.js?v=faf3b219"></script>
    <script src="../../../_static/js/domain_config.js?v=68ccafbe"></script>
    <script src="../../../_static/js/domain_updater.js?v=d33cbccf"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/how_to/training/multi_node';</script>
    <script src="https://cdn.jsdelivr.net/npm/glightbox/dist/js/glightbox.min.js"></script>
    <script src="../../../_static/js/code_annotation.js?v=217a77bb"></script>
    <script src="../../../_static/js/tab-set.js?v=4a5fa218"></script>
    <script src="../../../_static/js/glightbox-init.js?v=08cf799b"></script>
    <link rel="icon" href="../../../_static/osmo_favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Fault-Tolerant Training with Rescheduling" href="reschedule_backend_errors.html" />
    <link rel="prev" title="Single Node Training" href="single_node.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
    <meta name="docbuild:last-update" content="Dec 11, 2025"/>


  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="OSMO Documentation - Home"/>
    <img src="../../../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="OSMO Documentation - Home"/>
  
  
    <p class="title logo__title">OSMO Documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../deployment_guide/index.html">
    Deployment Guide
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">
<div class="version-selector-float">
  <select id="version-select" class="version-select-hidden" aria-label="Select documentation version">
    <option value="multi_node.html" selected data-version="main">
      main
    </option>
  </select>

  <!-- Custom styled dropdown -->
  <button type="button" class="version-badge" id="version-badge" aria-haspopup="listbox" aria-expanded="false">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor" aria-hidden="true">
      <path d="M15 4.75a3.25 3.25 0 1 1 6.5 0 3.25 3.25 0 0 1-6.5 0ZM2.5 19.25a3.25 3.25 0 1 1 6.5 0 3.25 3.25 0 0 1-6.5 0Zm0-14.5a3.25 3.25 0 1 1 6.5 0 3.25 3.25 0 0 1-6.5 0ZM5.75 6.5a1.75 1.75 0 1 0-.001-3.501A1.75 1.75 0 0 0 5.75 6.5Zm0 14.5a1.75 1.75 0 1 0-.001-3.501A1.75 1.75 0 0 0 5.75 21Zm12.5-14.5a1.75 1.75 0 1 0-.001-3.501A1.75 1.75 0 0 0 18.25 6.5Z"></path>
      <path d="M5.75 16.75A.75.75 0 0 1 5 16V8a.75.75 0 0 1 1.5 0v8a.75.75 0 0 1-.75.75Z"></path>
      <path d="M17.5 8.75v-1H19v1a3.75 3.75 0 0 1-3.75 3.75h-7a1.75 1.75 0 0 0-1.75 1.75H5A3.25 3.25 0 0 1 8.25 11h7a2.25 2.25 0 0 0 2.25-2.25Z"></path>
    </svg>
    <span id="version-number">main</span>
  </button>

  <div class="version-list" role="listbox">
    <a href="multi_node.html"
       role="option"
       class="current" aria-selected="true"
       data-version="main">
      main
    </a>
  </div>
</div>
<script>
(function() {
  var badge = document.getElementById('version-badge');
  var container = document.querySelector('.version-selector-float');
  var select = document.getElementById('version-select');

  if (!badge || !container || !select) return;

  // Toggle dropdown
  badge.onclick = function(e) {
    e.stopPropagation();
    container.classList.toggle('open');
  };

  // Close on outside click
  document.onclick = function(e) {
    if (!container.contains(e.target)) container.classList.remove('open');
  };

  // Navigate on select change
  select.onchange = function() {
    if (this.value) window.location.href = this.value;
  };
})();
</script>
</div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/OSMO/" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        



  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="OSMO Documentation - Home"/>
    <img src="../../../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="OSMO Documentation - Home"/>
  
  
    <p class="title logo__title">OSMO Documentation</p>
  
</a>


  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../deployment_guide/index.html">
    Deployment Guide
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="version-selector-float">
  <select id="version-select" class="version-select-hidden" aria-label="Select documentation version">
    <option value="multi_node.html" selected data-version="main">
      main
    </option>
  </select>

  <!-- Custom styled dropdown -->
  <button type="button" class="version-badge" id="version-badge" aria-haspopup="listbox" aria-expanded="false">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor" aria-hidden="true">
      <path d="M15 4.75a3.25 3.25 0 1 1 6.5 0 3.25 3.25 0 0 1-6.5 0ZM2.5 19.25a3.25 3.25 0 1 1 6.5 0 3.25 3.25 0 0 1-6.5 0Zm0-14.5a3.25 3.25 0 1 1 6.5 0 3.25 3.25 0 0 1-6.5 0ZM5.75 6.5a1.75 1.75 0 1 0-.001-3.501A1.75 1.75 0 0 0 5.75 6.5Zm0 14.5a1.75 1.75 0 1 0-.001-3.501A1.75 1.75 0 0 0 5.75 21Zm12.5-14.5a1.75 1.75 0 1 0-.001-3.501A1.75 1.75 0 0 0 18.25 6.5Z"></path>
      <path d="M5.75 16.75A.75.75 0 0 1 5 16V8a.75.75 0 0 1 1.5 0v8a.75.75 0 0 1-.75.75Z"></path>
      <path d="M17.5 8.75v-1H19v1a3.75 3.75 0 0 1-3.75 3.75h-7a1.75 1.75 0 0 0-1.75 1.75H5A3.25 3.25 0 0 1 8.25 11h7a2.25 2.25 0 0 0 2.25-2.25Z"></path>
    </svg>
    <span id="version-number">main</span>
  </button>

  <div class="version-list" role="listbox">
    <a href="multi_node.html"
       role="option"
       class="current" aria-selected="true"
       data-version="main">
      main
    </a>
  </div>
</div>
<script>
(function() {
  var badge = document.getElementById('version-badge');
  var container = document.querySelector('.version-selector-float');
  var select = document.getElementById('version-select');

  if (!badge || !container || !select) return;

  // Toggle dropdown
  badge.onclick = function(e) {
    e.stopPropagation();
    container.classList.toggle('open');
  };

  // Close on outside click
  document.onclick = function(e) {
    if (!container.contains(e.target)) container.classList.remove('open');
  };

  // Navigate on select change
  select.onchange = function() {
    if (this.value) window.location.href = this.value;
  };
})();
</script>
</div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/OSMO/" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">




<nav class="bd-docs-nav bd-links"
     aria-label="Table of Contents">
  <p class="bd-links__title" role="heading" aria-level="1">Table of Contents</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whats_next.html">Whatâ€™s Next</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/system_requirements.html">System Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/install/index.html">Install Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/profile.html">Setup Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/credentials.html">Setup Credentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/next_steps.html">Next Steps</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/hello_world/index.html">1. Hello World</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/requesting_resources.html">2. Requesting Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/template_and_tokens.html">3. Template and Tokens</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/data/index.html">4. Working with Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/serial_workflows/index.html">5. Serial Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/parallel_workflows/index.html">6. Parallel Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/combination_workflows/index.html">7. Combination Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/hardware_in_the_loop/index.html">8. Hardware In The Loop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/advanced_patterns.html">9. Advanced Patterns</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">How-to Guides</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../isaac_sim_sdg.html">Isaac Sim: Generating Synthetic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reinforcement_learning.html">Isaac Lab: Training Robot Policy with Reinforcement Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ros2_comm.html">ROS 2: Multi-Node Communication</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../training.html">TorchRun: Training Deep Learning Models</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="single_node.html">Single Node Training</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Multi-Node Distributed Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="reschedule_backend_errors.html">Fault-Tolerant Training with Rescheduling</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../isaac_groot_notebook.html">Isaac Gr00t: Interactive Notebook for Inference and Fine-tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hil.html">Hardware-in-the-Loop: Deploying Policy on Jetson</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://github.com/NVIDIA/OSMO/tree/main/workflows" rel="noreferrer" target="_blank">More Examples <svg aria-hidden="true" height="1.0em" style="display: inline-block; vertical-align: middle; fill: currentColor;" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Workflows</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../workflows/index.html">Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../workflows/specification/index.html">Specification</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../workflows/specification/barriers.html">Barriers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workflows/specification/checkpointing.html">Checkpointing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workflows/specification/exit_actions.html">Exit Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workflows/specification/file_injection.html">File Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workflows/specification/host_mounts.html">Host Mounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workflows/specification/inputs_and_outputs.html">Inputs and Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workflows/specification/resources.html">Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workflows/specification/secrets.html">Secrets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workflows/specification/templates_and_tokens.html">Templates and Special Tokens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workflows/specification/timeouts.html">Timeouts</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows/submission.html">Workflow Submission</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows/lifecycle/index.html">Workflow Lifecycle</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../workflows/interactive/index.html">Interactive Workflows</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../workflows/interactive/exec.html">Exec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workflows/interactive/port_forward.html">Port-Forward</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workflows/interactive/rsync.html">Rsync</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows/exit_codes.html">Exit Codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows/apps.html">Apps</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Resource Pools</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../resource_pools/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resource_pools/scheduling/index.html">Scheduling</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Help</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQs</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../troubleshooting/index.html">Troubleshooting</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/nccl.html">NCCL Errors</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../appendix/cli/index.html">CLI Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../appendix/cli/cli_app.html">osmo app</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendix/cli/cli_bucket.html">osmo bucket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendix/cli/cli_credential.html">osmo credential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendix/cli/cli_data.html">osmo data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendix/cli/cli_dataset.html">osmo dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendix/cli/cli_login.html">osmo login</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendix/cli/cli_logout.html">osmo logout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendix/cli/cli_pool.html">osmo pool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendix/cli/cli_profile.html">osmo profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendix/cli/cli_resource.html">osmo resource</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendix/cli/cli_task.html">osmo task</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendix/cli/cli_token.html">osmo token</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendix/cli/cli_version.html">osmo version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendix/cli/cli_workflow.html">osmo workflow</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>



      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link"><strong>User Guide</strong></a></li>
    
    
    <li class="breadcrumb-item"><a href="../training.html" class="nav-link">TorchRun: Training Deep Learning Models</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Multi-Node Distributed Training</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="multi-node-distributed-training">
<span id="training-multi-node"></span><h1>Multi-Node Distributed Training<a class="headerlink" href="#multi-node-distributed-training" title="Link to this heading">#</a></h1>
<p>You will learn how to train a model on multiple nodes in OSMO.</p>
<p>The complete workflow example is available <a class="reference external" href="https://github.com/NVIDIA/OSMO/tree/main/workflows/dnn_training/torchrun_multinode" rel="noreferrer" target="_blank">here <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a>.
More examples with other distributed training frameworks can be found <a class="reference external" href="https://github.com/NVIDIA/OSMO/tree/main/workflows/dnn_training" rel="noreferrer" target="_blank">here <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Before you proceed, confirm with your admin for NCCL configuration. This tutorial requires NCCL to be configured in the resource pool.</p>
</div>
<section id="making-a-torchrun-multi-node-training-script">
<h2>Making a TorchRun Multi-Node Training Script<a class="headerlink" href="#making-a-torchrun-multi-node-training-script" title="Link to this heading">#</a></h2>
<p>To train a model on multiple nodes in OSMO, you need to first make your training script compatible with distributed training,
for example, using <a class="reference external" href="https://github.com/NVIDIA/OSMO/blob/main/workflows/dnn_training/torchrun_multinode/train.py" rel="noreferrer" target="_blank">train.py <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a>.</p>
</section>
<section id="training-on-two-nodes">
<h2>Training on Two Nodes<a class="headerlink" href="#training-on-two-nodes" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">groups</span></code> enables tasks to be launched simultaneously and allow network communication between tasks.
OSMO token <code class="docutils literal notranslate"><span class="pre">{{host:&lt;task_name&gt;}}</span></code> can be used to get the hostname of the lead task for TorchRun setup.</p>
<p>Taking a two-node training as an example, the workflow spec can be written as follows:</p>
<div class="highlight-yaml notranslate"><div class="annotate highlight"><pre><span></span><span class="nt">workflow</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">train-multi-gpu</span>
<span class="w">  </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">    </span><span class="nt">default</span><span class="p">:</span>
<span class="w">      </span><span class="nt">gpu</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">      </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16</span>
<span class="w">      </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30Gi</span>
<span class="w">      </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30Gi</span>
<span class="w">  </span><span class="nt">groups</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">training</span>
<span class="w">    </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">master</span><span class="w">  </span><span class="c1"># (2)</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvcr.io/nvidia/pytorch:24.03-py3</span>
<span class="w">      </span><span class="nt">lead</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">  </span><span class="c1"># (3)</span>
<span class="w">      </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">bash</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">/tmp/master.sh</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">files</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/master.sh</span>
<span class="w">        </span><span class="nt">contents</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">set -ex</span>
<span class="w">          </span><span class="no">mkdir -p {{output}}/models</span>

<span class="w">          </span><span class="no"># Launch training</span>
<span class="w">          </span><span class="no">torchrun --nnodes 2 --nproc_per_node 8 --node_rank 0 \</span>
<span class="w">                    </span><span class="no">--master_addr {{host:master}} --master_port 29400 \</span>
<span class="w">                    </span><span class="no">/tmp/train.py --total_epochs 10 --batch_size 32 \</span>
<span class="w">                    </span><span class="no">--snapshot_path {{output}}/models/snapshot.pth</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/train.py</span>
<span class="w">        </span><span class="nt">localpath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">train.py</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">worker</span><span class="w">  </span><span class="c1"># (4)</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvcr.io/nvidia/pytorch:24.03-py3</span>
<span class="w">      </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">bash</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">/tmp/worker.sh</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">files</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/worker.sh</span>
<span class="w">        </span><span class="nt">contents</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">set -ex</span>
<span class="w">          </span><span class="no">mkdir -p {{output}}/models</span>

<span class="w">          </span><span class="no"># Launch training</span>
<span class="w">          </span><span class="no">torchrun --nnodes 2 --nproc_per_node 8 --node_rank 1 \</span>
<span class="w">                    </span><span class="no">--master_addr {{host:master}} --master_port 29400 \</span>
<span class="w">                    </span><span class="no">/tmp/train.py --total_epochs 10 --batch_size 32 \</span>
<span class="w">                    </span><span class="no">--snapshot_path {{output}}/models/snapshot.pth</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/train.py</span>
<span class="w">        </span><span class="nt">localpath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">train.py</span>
</pre></div>
<ol class="arabic simple">
<li><p>Master task for torchrun</p></li>
<li><p>Set to the lead of the group</p></li>
<li><p>Worker task that will communicate with the master task</p></li>
</ol>
</div>
<p>In some cases, you may want to get the IP address of the task instead of the hostname.
Use <code class="docutils literal notranslate"><span class="pre">nslookup</span></code> as an example to resolve the hostname to an IP address:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">TASK_IP</span><span class="o">=</span><span class="k">$(</span>nslookup<span class="w"> </span>-type<span class="o">=</span>A<span class="w"> </span><span class="o">{{</span>host:master<span class="o">}}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-oP<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;Address: \K\d[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-n1<span class="k">)</span>
</pre></div>
</div>
</section>
<section id="scaling-up-to-arbitrary-number-of-nodes">
<h2>Scaling up to Arbitrary Number of Nodes<a class="headerlink" href="#scaling-up-to-arbitrary-number-of-nodes" title="Link to this heading">#</a></h2>
<p>Once the two-node training is successful, you can scale up the training to more nodes with templating:</p>
<div class="highlight-jinja notranslate"><div class="annotate highlight"><pre><span></span><span class="x">workflow:</span>
<span class="x">  name: train-multi-gpu</span>
<span class="x">  resources:</span>
<span class="x">    default:</span>
<span class="x">      gpu: </span><span class="cp">{{</span> <span class="nv">n_gpus_per_node</span> <span class="cp">}}</span>
<span class="x">      cpu: 16</span>
<span class="x">      memory: 30Gi</span>
<span class="x">      storage: 30Gi</span>
<span class="x">  groups:</span>
<span class="x">  - name: training</span>
<span class="x">    tasks:</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">item</span> <span class="k">in</span> <span class="nv">range</span><span class="o">(</span><span class="nv">n_nodes</span><span class="o">)</span> <span class="cp">%}</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">item</span> <span class="o">==</span> <span class="m">0</span> <span class="cp">%}</span>
<span class="x">    - name: master  # (1)</span>
<span class="x">      lead: true  # (2)</span>
<span class="x">      outputs:  # (3)</span>
<span class="x">      - dataset:</span>
<span class="x">          name: </span><span class="cp">{{</span> <span class="nv">output_dataset</span> <span class="cp">}}</span>
<span class="x">          path: models</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
<span class="x">    - name: worker_</span><span class="cp">{{</span><span class="nv">item</span><span class="cp">}}</span><span class="x">  # (4)</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="x">      image: nvcr.io/nvidia/pytorch:24.03-py3</span>
<span class="x">      command: [bash]</span>
<span class="x">      args: [/tmp/run.sh]</span>
<span class="x">      files:</span>
<span class="x">      - path: /tmp/run.sh</span>
<span class="x">        contents: |</span>
<span class="x">          set -ex</span>
<span class="x">          mkdir -p </span><span class="cp">{{</span><span class="nv">output</span><span class="cp">}}</span><span class="x">/models</span>

<span class="x">          # Launch training</span>
<span class="x">          torchrun --nnodes </span><span class="cp">{{</span><span class="nv">n_nodes</span><span class="cp">}}</span><span class="x"> --nproc_per_node </span><span class="cp">{{</span><span class="nv">n_gpus_per_node</span><span class="cp">}}</span><span class="x"> --node_rank </span><span class="cp">{{</span><span class="nv">item</span><span class="cp">}}</span><span class="x"> \</span>
<span class="x">                    --master_addr </span><span class="cp">{{</span><span class="nv">host</span><span class="o">:</span><span class="nv">master</span><span class="cp">}}</span><span class="x"> --master_port </span><span class="cp">{{</span><span class="nv">master_port</span><span class="cp">}}</span><span class="x"> \</span>
<span class="x">                    /tmp/train.py --total_epochs </span><span class="cp">{{</span><span class="nv">n_epochs</span><span class="cp">}}</span><span class="x"> --batch_size </span><span class="cp">{{</span><span class="nv">batch_size</span><span class="cp">}}</span><span class="x"> \</span>
<span class="x">                    --snapshot_path </span><span class="cp">{{</span><span class="nv">output</span><span class="cp">}}</span><span class="x">/models/snapshot.pth</span>
<span class="x">      - path: /tmp/train.py</span>
<span class="x">        localpath: train.py</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>

<span class="x">default-values:</span>
<span class="x">  n_gpus_per_node: 8</span>
<span class="x">  n_nodes: 2</span>
<span class="x">  master_port: 29400</span>
<span class="x">  n_epochs: 10</span>
<span class="x">  batch_size: 32</span>
<span class="x">  output_dataset: my-trained-model  # The name of the output dataset</span>
</pre></div>
<ol class="arabic simple">
<li><p>Master task for torchrun</p></li>
<li><p>Set to the lead of the group</p></li>
<li><p>Only save the trained model in lead task</p></li>
<li><p>Worker task that will communicate with the master task</p></li>
</ol>
</div>
<p>Now you can change default values with the commandline. For example,
this shows how to submit the workflow with 4 nodes and 4 GPUs per node:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>osmo<span class="w"> </span>workflow<span class="w"> </span>submit<span class="w"> </span>&lt;your<span class="w"> </span>workflow<span class="w"> </span>spec<span class="w"> </span>path&gt;<span class="w"> </span>--set<span class="w"> </span><span class="nv">n_nodes</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="nv">n_gpus_per_node</span><span class="o">=</span><span class="m">4</span>
</pre></div>
</div>
</section>
<section id="synchronizing-training-start-time-optional">
<span id="training-multi-node-sync"></span><h2>Synchronizing Training Start Time (Optional)<a class="headerlink" href="#synchronizing-training-start-time-optional" title="Link to this heading">#</a></h2>
<p>OSMO makes sure that all tasks in the same group start entry commands at the same time.
This prevents different initialization timing that causes timeout issues.</p>
<p>In some cases, you may want to synchronize the training starting time by yourself.
For example, you need to install some heavy dependencies before the training starts and that can take varies of time.
You can use the a barrier script like <a class="reference external" href="https://github.com/NVIDIA/OSMO/blob/main/workflows/dnn_training/torchrun_multinode/osmo_barrier.py" rel="noreferrer" target="_blank">osmo_barrier.py <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> to synchronize before the training launches.</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="x">groups:</span>
<span class="x">- name: training</span>
<span class="x">  tasks:</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">item</span> <span class="k">in</span> <span class="nv">range</span><span class="o">(</span><span class="nv">n_nodes</span><span class="o">)</span> <span class="cp">%}</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">item</span> <span class="o">==</span> <span class="m">0</span> <span class="cp">%}</span>
<span class="x">  - name: master</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
<span class="x">  - name: worker_</span><span class="cp">{{</span><span class="nv">item</span><span class="cp">}}</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="x">    files:</span>
<span class="x">    - path: /tmp/run.sh</span>
<span class="x">      contents: |</span>
<span class="x">        # Time varying code</span>

<span class="x">        # Synchronize the master and all workers</span>
<span class="x">        python3 /tmp/osmo_barrier.py --num_nodes </span><span class="cp">{{</span><span class="nv">n_nodes</span><span class="cp">}}</span><span class="x"> --connect </span><span class="cp">{{</span><span class="nv">host</span><span class="o">:</span><span class="nv">master</span><span class="cp">}}</span><span class="x"> --rank </span><span class="cp">{{</span><span class="nv">item</span><span class="cp">}}</span>

<span class="x">        # Launch training</span>
<span class="x">    - path: /tmp/train.py</span>
<span class="x">      localpath: train.py</span>
<span class="x">    - path: /tmp/osmo_barrier.py</span>
<span class="x">      localpath: osmo_barrier.py</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="single_node.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Single Node Training</p>
      </div>
    </a>
    <a class="right-next"
       href="reschedule_backend_errors.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fault-Tolerant Training with Rescheduling</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            


              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#making-a-torchrun-multi-node-training-script">Making a TorchRun Multi-Node Training Script</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-on-two-nodes">Training on Two Nodes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling-up-to-arbitrary-number-of-nodes">Scaling up to Arbitrary Number of Nodes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#synchronizing-training-start-time-optional">Synchronizing Training Start Time (Optional)</a></li>
</ul>
  </nav></div>

</div></div>
              
            

          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
<a class="footer-brand logo" href="https://www.nvidia.com">
  <img src="../../../_static/nvidia-logo-horiz-rgb-1c-blk-for-screen.svg" class="logo__image only-light" alt="NVIDIA"/>
  <img src="../../../_static/nvidia-logo-horiz-rgb-1c-wht-for-screen.svg" class="logo__image only-dark" alt="NVIDIA"/>
</a></div>
      
        <div class="footer-item">

<div class="footer-links">
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/">Privacy Policy</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/">Manage My Privacy</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/preferences/start/">Do Not Sell or Share My Data</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/">Terms of Service</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/accessibility/">Accessibility</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/company-policies/">Corporate Policies</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/product-security/">Product Security</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/contact/">Contact</a>
  
  
  
</div>
</div>
      
        <div class="footer-item">




  <p class="copyright">
    
      Copyright Â© 2025 NVIDIA CORPORATION &amp; AFFILIATES.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item"><p class="last-updated">
  Last updated on Dec 11, 2025.
  <br/>
</p></div>
      
    </div>
  
  
  
</div>

  </footer>
  </body>
</html>